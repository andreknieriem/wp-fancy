var fancy=function(){function e(){var e=[t("#gallery"),t("#mainContent"),t("#sidebar")];return e}var a={},t=jQuery,n=!1,i=!0,o=!1,r=!1,l=!1;return mobile=t(window).width()>991?!1:!0,adminbar=t("body").hasClass("admin-bar"),headerHeight=adminbar?102:70,pageCache={},instance=!1,a.init=function(){t(".cardWrapper").css("perspective",800),a.resize(),t(".focuspoint").focusPoint(),"pushState"in history&&a.enableFastMode(),a.setupLightbox(),a.setupGallery()},a.when_content_loaded=function(e,a){var t=e.find("img, iframe, frame, script"),n=t.length,i=0;n?t.on("load",function(){i++,i==n&&a()}):a()},a.resize=function(){var e=t(window).height(),a=(t(window).width(),t("#mainContent .card").height()),n=(t("#sidebar .card").height(),e-headerHeight);winHeight=t(window).innerHeight()-headerHeight,a>n&&(n=a),tablet=t("#tablet-indicator").is(":visible"),phone=t("#mobile-indicator").is(":visible"),tablet||phone?tablet&&!phone?(mobile=!0,t(".cardWrapper").css("perspective",800),t("#mainContent .card, #sidebar .card").removeAttr("style"),t("#gallery,#gallery .card, .focuspoint").removeAttr("style"),mHeight=t("#mainContent .card").height(),sHeight=t("#sidebar .card").height(),n=mHeight,sHeight>mHeight&&(n=sHeight),t("#mainContent .card, #sidebar .card").css({"min-height":n})):phone&&(mobile=!0,t("#gallery,#gallery .card, .focuspoint").removeAttr("style"),t("#mainContent .card, #sidebar .card").removeAttr("style")):(mobile=!1,t("#gallery,#gallery .card, .focuspoint").css({"min-height":winHeight}),t(".cardWrapper").css("perspective",800),t("#mainContent .card, #sidebar .card").css({"min-height":n}))},a.setupGallery=function(){var e=t(".galImage").length;if(e>1){t("<div>").addClass("dotNavi").appendTo("#gallery .cardFace");for(var a=0;e>a;a++)t("<a>").attr("href","#").addClass("dot").appendTo(".dotNavi");t(".dotNavi a").first().addClass("active")}},a.setupLightbox=function(){instance&&instance.destroy(),instance=t('.content a[href$=".gif"], .content a[href$=".jpg"], .content a[href$=".png"], .content a[href$=".bmp"]').simpleLightbox({nav:!1,closeText:'<i class="fa fa-times"></i>'})},a.enableFastMode=function(){t("body").on("click","a",function(e){var n=t(this).prop("href"),i=t(this).prop("target"),o=t(this).hasClass("no-ajax");o||"_blank"!=i&&(n.indexOf("#")>-1||n.indexOf("wp-admin/")>-1||n.indexOf("wp-login.php")>-1||null==n.match(/\.(jpeg|jpg|gif|png)$/)&&(e.preventDefault(),n=n.match(/\.de(\/.*)/)[1],mobile&&(t(".topmenu, .navbar-toggle").removeClass("active"),t(".topmenu li").removeClass("open")),a.niceLoad(n)))}),setTimeout(function(){t(window).bind("popstate",a.handleHistoryState)},500)},a.handleHistoryState=function(){o||a.niceLoad(window.location.pathname+window.location.search)},a.niceLoad=function(e){o||(mobile?a.mobileGoOut(e):a.goOut(e))},a.docReady=function(){a.resize(),a.when_content_loaded(t("#mainContent"),a.resize),a.setupLightbox(),t(".focuspoint").focusPoint(),t(".cardWrapper").css("perspective",800),t("header#header, #gallery").css({"-webkit-transform":"translateZ(0)"}),a.setupGallery(),t("video,audio").mediaelementplayer(),t(".galImage").swipe({swipe:function(e,t){dir="next","right"==t&&(dir="prev"),a.slideShow(dir)}})},a.calcGal=function(){var e=t("#gallery .galImage.active"),n=e.data("imageW"),i=e.data("imageH"),o=(e.data("imageSrc"),t(window).width()),r=e.height(),l=parseFloat(e.data("focusX")),s=parseFloat(e.data("focusY")),c=(e.find("img").first(),n/o),d=i/r,u=0,m=0,h="none",g="none";return n>o&&i>r&&(c>d?h="100%":g="100%"),c>d?u=a.calcShift(d,o,n,l):d>c&&(m=a.calcShift(c,r,i,s,!0)),[u,m,h,g]},a.calcShift=function(e,a,t,n,i){var o=Math.floor(a/2),r=(n+1)/2,l=Math.floor(t/e),s=Math.floor(r*l);i&&(s=l-s);var c=s-o,d=l-s,u=a-o;return u>d&&(c-=u-d),0>c&&(c=0),-100*c/a},a.goOut=function(n){o=!0,t(e()).each(function(e,r){var r=t(r),l=200*e;t(this).find(".card").velocity({translateZ:"-600px",rotateY:"-50deg",opacity:0},{duration:800,delay:l,easing:"easeInOutQuad",complete:function(){if(2==e){if(o=!1,i=!1,t(window).scrollTop(0),a.resetGal(),pageCache[n])return void a.processContent(pageCache[n],n);t.ajax({type:"html",url:n,success:function(e){pageCache[this.url]=e,a.processContent(pageCache[this.url],this.url)}})}}})})},a.mobileGoOut=function(e){o=!0,t("#wholecontent").fadeTo("fast",.33,function(){return o=!1,i=!1,pageCache[e]?void a.processContent(pageCache[e],e):void t.ajax({type:"html",url:e,success:function(e){pageCache[this.url]=e,a.processContent(pageCache[this.url],this.url)}})})},a.comeBack=function(){i=!0,o=!0,t(e().reverse()).each(function(e,a){var a=t(a),n=200*e;t(this).find(".card").velocity({rotateY:0,translateZ:0,opacity:1},{duration:800,delay:n,easing:"easeInOutQuad",complete:function(){2==e&&(o=!1)}})})},a.mobileComeBack=function(){i=!0,o=!0,t("#wholecontent").fadeTo("fast",1,function(){o=!1})},a.processContent=function(e,r){var l=t(t.parseHTML(e)),s=l.find("#mainContent .cardFace"),c=l.find("#gallery .cardFace"),d=l.find("#sidebar .cardFace");e=e.replace(/[\r\n]/g,"");{var u=e.match(/<title>(.*)<\/title>/)[1],m=e.match(/<body class="([\w_\s-]+)">/);e.match(/<!-- slideshow -->(.*)<!-- \/slideshow -->/)}""!=window.location.search&&history.pushState({},u,r),r!=window.location.pathname&&history.pushState({},u,r);var h=window.location.pathname.split("/");if(""==h[0]&&h.shift(),urlSegment=h[0],"category"==h[0]&&(urlSegment=h[1]),t(".topmenu .current-menu-item").removeClass("current-menu-item"),t(".topmenu .current-menu-parent").removeClass("current-menu-parent"),h)if(""==urlSegment)t('.topmenu a[href="'+window.location.origin+urlSegment+'/"]').parent().addClass("current-menu-item");else{var g=t('.topmenu a[href*="'+urlSegment+'"]').parent();g.addClass("current-menu-item"),g.parents("li").length>0&&g.parents("li").addClass("current-menu-parent")}t("title").html(""!=u?u:"Andre Knieriem Webdesign/-development"),t("body").prop("class",m[1]),o||(t("#mainContent .card").html(s),t("#gallery .card").html(c),t("#sidebar .card").html(d)),t("#mainContent .card, #sidebar .card").css({"min-height":"0"}),a.docReady(),n=!0,i||(mobile?a.mobileComeBack():a.comeBack())},t(window).resize(function(){a.resize()}),a.slideShow=function(e){r=!0;var a=t(".galImage.active");if(0==a.length&&(a=t("next"==e?".galImage:last":".galImage:first")),"next"==e)var n=a.next(".galImage").length?a.next(".galImage"):t(".galImage:first");else var n=a.prev(".galImage").length?a.prev(".galImage"):t(".galImage:last");a.addClass("last-active").fadeOut(500),n.addClass("active").fadeIn(500,function(){r=!1}),a.removeClass("active last-active"),index=t(".galImage").index(t(".galImage.active")),t(".dotNavi a").removeClass("active"),t(".dotNavi a").eq(index).addClass("active")},a.dotNavigation=function(e){r=!0;var a=t(".galImage.active");$next=t(".galImage").eq(e),a.addClass("last-active").fadeOut(500),$next.addClass("active").fadeIn(500,function(){r=!1}),a.removeClass("active last-active")},t(".menu-hauptmenu-container .menu-item-has-children").each(function(e,a){t("<span>").addClass("mobileSub").html('<i class="fa fa-angle-down"></i>').appendTo(t(a))}),t(document).on("click","span.mobileSub",function(e){e.preventDefault(),t(this).parent().find(".sub-menu").show()}),t(".galImage").swipe({swipe:function(e,t){dir="next","right"==t&&(dir="prev"),a.slideShow(dir)}}),t("#gallery.closed").on({mouseenter:function(){elem=t("#gallery.closed .galImage.active"),elem.velocity({scale:1.1},{duration:250})},mouseleave:function(){elem=t("#gallery.closed .galImage.active"),elem.velocity({scale:1},{duration:250})}}),t(document).on("click","button.openGallery",function(e){e.preventDefault(),l=!0,t(".openGallery").hide(),t("#gallery").removeClass("closed");var n=a.calcGal();elem=t(".galImage.active"),elem.velocity({scale:1},{duration:10}),t(".galImage.active img").css({"max-height":n[2],"max-width":n[3]}),t(".galImage.active img").animate({left:n[0]+"%",top:n[1]+"%",width:"auto"},150,function(){t("#gallery").animate({width:"100%"},250,function(){t(".galImage").adjustFocus(),t(".navigation button, .dotNavi").fadeIn("fast")})})}),a.resetGal=function(){l=!1,t(".navigation button, .dotNavi").hide(),t("#gallery").addClass("closed"),t(".openGallery").show(),t("#gallery").width("45%"),t(".galImage img").css({width:"auto"}),t(".focuspoint").adjustFocus()},t(document).on("click",".closeGallery",function(e){e.preventDefault(),l=!1,t(".navigation button, .dotNavi").hide(),t("#gallery").addClass("closed"),mobile?t(".openGallery").fadeIn("fast"):t("#gallery").animate({width:"45%"},250,function(){t(".galImage img").css({width:"auto"}),t(".focuspoint").adjustFocus(),t(".openGallery").fadeIn("fast")})}),t(document).on("click",".search-toggle",function(e){e.preventDefault(),t(".mobileSearch").toggleClass("open"),t(".mobileSearch").slideToggle("50",function(){t(".mobileSearch").hasClass("open")&&t(".mobileSearch input#s").focus()})}),t(document).on("click",".dotNavi a",function(e){if(e.preventDefault(),!r){var n=t(".dotNavi a").index(t(this));t(".dotNavi a").removeClass("active"),t(this).addClass("active"),a.dotNavigation(n)}}),t(document).on("click",".nextButton, .prevButton",function(e){e.preventDefault(),dir="next",t(this).hasClass("prevButton")&&(dir="prev"),a.slideShow(dir)}),t(document).on("click",".navbar-toggle",function(e){e.preventDefault(),t(window).scrollTop(0),t(this).toggleClass("active"),t(".topmenu").toggleClass("active")}),t(document).on("click",".menu-header-search a",function(e){e.preventDefault();var a=t(this).parents("li"),n=t(".menu-header-search .formfield");a.hasClass("opened")?n.fadeOut("fast"):n.fadeIn("fast",function(){n.find("input").focus()}),a.toggleClass("opened")}),t(document).on("click",".mobileSub",function(e){e.preventDefault();var a=t(this);a.parents("li").toggleClass("open")}),t("#searchform,.searchform").on("submit",function(e){e.preventDefault();var n=t(this).find("input").val(),i="/?s="+n;""!=n&&(t(".menu-header-search").removeClass("opened"),t(".menu-header-search .formfield").fadeOut("fast"),t(".searchform #s").val(""),a.niceLoad(i))}),t(window).load(function(){a.resize()}),t(document).on("click",function(e){var a=t(e.target);0==a.closest(".menu-header-search").length&&(t(".menu-header-search").removeClass("opened"),t(".menu-header-search .formfield").fadeOut("fast"))}),t(document).on("click",".reply",function(e){e.preventDefault(),t(this).find("a").click()}),a}();jQuery(function(){fancy.init()});